# TestEffectiveMobile

## Описание системы

### База данных

#### Таблица `users`
- `id` - первичный ключ
- `email` - уникальный email пользователя
- `first_name` - имя
- `last_name` - фамилия  
- `middle_name` - отчество
- `password` - хеш пароля (bcrypt)
- `is_active` - активен ли пользователь
- `is_staff` - является ли сотрудником
- `date_joined` - дата регистрации

#### Таблица `roles`
- `id` - первичный ключ
- `name` - название роли (уникальное)
- `description` - описание роли

#### Таблица `user_roles`
- `user_id` - ссылка на пользователя
- `role_id` - ссылка на роль
- `assigned_at` - дата назначения роли

#### Таблица `business_elements`
- `id` - первичный ключ
- `name` - название элемента
- `code` - код элемента (уникальный)
- `description` - описание элемента

#### Таблица `access_rules`
- `role_id` - ссылка на роль
- `element_id` - ссылка на бизнес-элемент
- `read_permission` - разрешение на чтение своих
- `create_permission` - разрешение на создание
- `update_permission` - разрешение на обновление своих
- `delete_permission` - разрешение на удаление своих
- `read_all_permission` - разрешение на чтение всех
- `update_all_permission` - разрешение на обновление всех
- `delete_all_permission` - разрешение на удаление всех

### API Endpoints

#### Аутентификация
- `POST /api/auth/register/` - регистрация
- `POST /api/auth/login/` - вход
- `POST /api/auth/logout/` - выход
- `GET /api/auth/profile/` - профиль пользователя
- `PUT /api/auth/profile/` - обновление профиля
- `DELETE /api/auth/delete-account/` - удаление аккаунта

#### Бизнес-логика
- `GET /api/business/products/` - список продуктов
- `GET /api/business/orders/` - список заказов

#### Администрирование (только для staff)
- `GET/POST /api/auth/roles/` - управление ролями
- `GET/POST /api/auth/access-rules/` - управление правилами доступа
- `POST /api/auth/user-roles/` - назначение ролей пользователям

### Правила доступа

#### Роли и их права:

**Администратор (admin):**
- Полный доступ ко всем ресурсам
- Может управлять пользователями, ролями и правилами

**Менеджер (manager):**
- Чтение и обновление всех продуктов и заказов
- Создание новых продуктов и заказов
- Не может удалять данные

**Пользователь (user):**
- Чтение только своих данных
- Создание и обновление только своих заказов
- Не может управлять продуктами

### Как тестировать

1. Зарегистрируйте нового пользователя через форму
2. Войдите под тестовыми пользователями:
   - admin@example.com / admin123
   - manager@example.com / manager123  
   - user@example.com / user123

3. Проверьте разные уровни доступа:
   - Админ видит все продукты и заказы
   - Менеджер видит все, но не может удалять
   - Пользователь видит только свои данные

### Технологии
- Django 4.2
- Django REST Framework
- PostgreSQL
- JWT для аутентификации
- bcrypt для хеширования паролей
